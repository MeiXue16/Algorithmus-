"""
google translate

urllib.request.Request
urllib.request.urlopen()
urllib.parse.urlencode()
发起post请求
"""
import json
from urllib.request import Request, urlopen
from urllib.parse import urlencode
import ssl
ssl._create_default_https_context =ssl._create_unverified_context

url = 'https://fanyi.baidu.com/sug'
headers = {
    'User-Agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) '
                  'Version/13.0.3 Mobile/15E148 Safari/604.1',
    'Cookie': 'BAIDUID=67B8FF6B0E0C2A2A2DA834A054B901B0:FG=1; BIDUPSID=67B8FF6B0E0C2A2A2DA834A054B901B0; PSTM=1642338140; H_WISE_SIDS=110085_127969_176399_179348_184716_185631_188741_189755_194085_194519_194530_196428_197242_197471_197711_197955_199023_199576_201193_203310_203880_203882_203885_204313_204713_204715_204717_204720_204859_204906_205218_205420_205424_205751_206705_207264_207729_208001_208064_208721_209345_209395_209568_209748_209859_210127_210359_210443_210580_210670_210757_210792_210851_210892_210917_211180_211207_211301_211351_211441_211457_211558_211580_211692_211732_211758_211867_212295_212533_212543_212594_212618_212771_212797_212869_212967_212976_213003_213035_213060_213139_213253_213272_213355_213550_213567; H_PS_PSSID=26350; ZFY=Cf0X08g:A5v3PjsBVp1UbADmDbkoLcuDx4TMl8FTFkVg:C; BAIDUID_BFESS=868880DC8C9039508E1AF499A10EE0DE:FG=1; ZD_ENTRY=google; H_WISE_SIDS_BFESS=110085_127969_176399_179348_184716_185631_188741_189755_194085_194519_194530_196428_197242_197471_197711_197955_199023_199576_201193_203310_203880_203882_203885_204313_204713_204715_204717_204720_204859_204906_205218_205420_205424_205751_206705_207264_207729_208001_208064_208721_209345_209395_209568_209748_209859_210127_210359_210443_210580_210670_210757_210792_210851_210892_210917_211180_211207_211301_211351_211441_211457_211558_211580_211692_211732_211758_211867_212295_212533_212543_212594_212618_212771_212797_212869_212967_212976_213003_213035_213060_213139_213253_213272_213355_213550_213567; RT="z=1&dm=baidu.com&si=2s9njdv9b9y&ss=l6jqlyv5&sl=8&tt=whc&bcn=https%3A%2F%2Ffclog.baidu.com%2Flog%2Fweirwood%3Ftype%3Dperf&ld=dfg1&ul=disj&hd=diu1"; APPGUIDE_10_0_2=1; REALTIME_TRANS_SWITCH=1; FANYI_WORD_SWITCH=1; HISTORY_SWITCH=1; SOUND_SPD_SWITCH=1; SOUND_PREFER_SWITCH=1; Hm_lvt_64ecd82404c51e03dc91cb9e8c025574=1660336257; Hm_lpvt_64ecd82404c51e03dc91cb9e8c025574=1660336257; ab_sr=1.0.1_ZmUxYWRkNDc2NzNlMzNiNGMxM2E3OTM4NDA3YTQ1NjdlOTRmYmFjZWY2OTJhYWRiZTU2OTVkNmUyYjlhMDAzZmIxNThhYzYxM2M0ZjAwZDZlNGVhZmE2ZjFmNjRjZjg4NTZmYjM0YjZjYTZmYWZlMzU0MGQ1NTU1NzdiNTYwODYxM2Q1NjlkNWRjZTgxMjZhZmE2ODIxNjVhNGNkMzUwMQ=='
}
def translate(kw):
    data = {
        'kw': kw
    }
    #Request()中data参数是byte类型
    req =Request(url,
                 data =urlencode(data).encode('utf-8'),
                 headers= headers)
    response = urlopen(req)
    assert response.code==200

    json_data =response.read()

    content_encode= response.getheader('Content-Type')
    content_encode='utf-8' if content_encode is None else content_encode.split('='[-1])
    return json.loads(json_data.decode('utf-8'))

print(translate('apple'))